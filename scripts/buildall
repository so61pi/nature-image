#!/bin/sh

# We do not want this
# set -e

# ASCII Font
#   ANSI Shadow

NATURE_LINUX_BUILD_STATUS=0

if [ -z "$NATURE_LINUX_BUILD_EXCLUDE_CETACEAN_IMAGE" ]; then
    (
        if [ -z "$NATURE_LINUX_BUILD_BORING" ]; then
            echo '                                                                   '
            echo ' ██████╗███████╗████████╗ █████╗  ██████╗███████╗ █████╗ ███╗   ██╗'
            echo '██╔════╝██╔════╝╚══██╔══╝██╔══██╗██╔════╝██╔════╝██╔══██╗████╗  ██║'
            echo '██║     █████╗     ██║   ███████║██║     █████╗  ███████║██╔██╗ ██║'
            echo '██║     ██╔══╝     ██║   ██╔══██║██║     ██╔══╝  ██╔══██║██║╚██╗██║'
            echo '╚██████╗███████╗   ██║   ██║  ██║╚██████╗███████╗██║  ██║██║ ╚████║'
            echo ' ╚═════╝╚══════╝   ╚═╝   ╚═╝  ╚═╝ ╚═════╝╚══════╝╚═╝  ╚═╝╚═╝  ╚═══╝'
            echo '-------------------------------------------------------------------'
        fi

        IMAGE=cetacean-image . ./setup
        bitbake cetacean-firmware
    )
    if [ $? -ne 0 ]; then
        NATURE_LINUX_BUILD_STATUS=1
    fi
fi

if [ -z "$NATURE_LINUX_BUILD_EXCLUDE_RODENT_IMAGE" ]; then
    (
        if [ -z "$NATURE_LINUX_BUILD_BORING" ]; then
            echo '                                                    '
            echo '██████╗  ██████╗ ██████╗ ███████╗███╗   ██╗████████╗'
            echo '██╔══██╗██╔═══██╗██╔══██╗██╔════╝████╗  ██║╚══██╔══╝'
            echo '██████╔╝██║   ██║██║  ██║█████╗  ██╔██╗ ██║   ██║   '
            echo '██╔══██╗██║   ██║██║  ██║██╔══╝  ██║╚██╗██║   ██║   '
            echo '██║  ██║╚██████╔╝██████╔╝███████╗██║ ╚████║   ██║   '
            echo '╚═╝  ╚═╝ ╚═════╝ ╚═════╝ ╚══════╝╚═╝  ╚═══╝   ╚═╝   '
            echo '----------------------------------------------------'
        fi

        IMAGE=rodent-image . ./setup
        bitbake rodent-flasher-image
    )
    if [ $? -ne 0 ]; then
        NATURE_LINUX_BUILD_STATUS=1
    fi
fi

if [ -z "$NATURE_LINUX_BUILD_EXCLUDE_LIZARD_IMAGE" ]; then
    (
        if [ -z "$NATURE_LINUX_BUILD_BORING" ]; then
            echo '                                           '
            echo '██╗     ██╗███████╗ █████╗ ██████╗ ██████╗ '
            echo '██║     ██║╚══███╔╝██╔══██╗██╔══██╗██╔══██╗'
            echo '██║     ██║  ███╔╝ ███████║██████╔╝██║  ██║'
            echo '██║     ██║ ███╔╝  ██╔══██║██╔══██╗██║  ██║'
            echo '███████╗██║███████╗██║  ██║██║  ██║██████╔╝'
            echo '╚══════╝╚═╝╚══════╝╚═╝  ╚═╝╚═╝  ╚═╝╚═════╝ '
            echo '-------------------------------------------'
        fi

        IMAGE=lizard-image . ./setup
        bitbake lizard-firmware
    )
    if [ $? -ne 0 ]; then
        NATURE_LINUX_BUILD_STATUS=1
    fi
fi

exit $NATURE_LINUX_BUILD_STATUS
